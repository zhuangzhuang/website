<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="description" />
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <title>Cake - Criteria</title>
        <link href="/assets/css/mermaid.css" rel="stylesheet">
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/bootstrap/bootstrap.css" rel="stylesheet" />
        <link href="/assets/css/adminlte/AdminLTE.css" rel="stylesheet" />
        <link href="/assets/css/theme/theme.css" rel="stylesheet" />
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/assets/css/override.css" rel="stylesheet" />
        <script src="/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>        
        <script src="/assets/js/app.min.js"></script>         
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/assets/js/mermaid.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/assets/js/html5shiv.min.js"></script>
        <script src="/assets/js/respond.min.js"></script>
        <![endif]-->  

        <script type="text/javascript" src="/assets/js/anchor.min.js"></script>
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/" class="logo">

                                <!-- mini logo for sidebar mini 50x50 pixels -->
                                <span class="logo-mini"><img src="/assets/img/logo.png"></span>
                                <!-- logo for regular state and mobile devices -->
                                <span class="logo-lg"><img src="/assets/img/logo.png"></span>
                                            </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/blog">Blog</a></li>
        <li class="active"><a href="/docs">Documentation</a></li>
        <li><a href="/dsl">Reference</a></li>
        <li><a href="/addins">Addins</a></li>
        <li><a href="/api">API</a></li>
        <li><a href="/faq">FAQ</a></li>
        <li><a href="https://github.com/cake-build/cake"><i class="fa fa-github"></i> Source</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
        <div><p><a href="https://github.com/cake-build/website/blob/develop/input/docs/fundamentals/criteria.md"><i class="fa fa-pencil-square" aria-hidden="true"></i> Edit Content</a></p></div>
    <div id="infobar-headings"></div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        
                <li class="treeview">
                    <a href="/docs/overview">Overview</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/overview/features">Features</a></li>
                <li><a href="/docs/overview/requirements">Requirements</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/tutorials">Tutorials</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/tutorials/getting-started">Getting Started</a></li>
                <li><a href="/docs/tutorials/setting-up-a-new-project">Setting Up A New Project</a></li>
                <li><a href="/docs/tutorials/powershell-security">Powershell Security</a></li>
                <li><a href="/docs/tutorials/extending-the-bootstrapper">Extending The Bootstrapper</a></li>
                <li><a href="/docs/tutorials/using-cake-pre-release">Using Cake Pre Release</a></li>
                <li><a href="/docs/tutorials/pinning-cake-version">Pinning Cake Version</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/docs/fundamentals">Fundamentals</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/fundamentals/tasks">Tasks</a></li>
                <li><a href="/docs/fundamentals/dependencies">Dependencies</a></li>
                <li class="selected"><a href="/docs/fundamentals/criteria">Criteria</a></li>
                <li><a href="/docs/fundamentals/error-handling">Error Handling</a></li>
                <li><a href="/docs/fundamentals/finally-block">Finally Block</a></li>
                <li><a href="/docs/fundamentals/asynchronous-tasks">Asynchronous Tasks</a></li>
                <li><a href="/docs/fundamentals/setup-and-teardown">Setup And Teardown</a></li>
                <li><a href="/docs/fundamentals/running-targets">Running Targets</a></li>
                <li><a href="/docs/fundamentals/args-and-environment-vars">Arguments And Environment Variables</a></li>
                <li><a href="/docs/fundamentals/aliases">Script Aliases</a></li>
                <li><a href="/docs/fundamentals/preprocessor-directives">Preprocessor Directives</a></li>
                <li><a href="/docs/fundamentals/configuration">Configuration</a></li>
                <li><a href="/docs/fundamentals/default-configuration-values">Default Configuration Values</a></li>
                <li><a href="/docs/fundamentals/modules">Modules</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/tools">Tools</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/tools/installing-tools">Installing Tools</a></li>
                <li><a href="/docs/tools/tool-resolution">Tool Resolution</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/cli">The Command Line</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/cli/usage">Usage Information</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/editors">Editors</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/editors/atom">Atom</a></li>
                <li><a href="/docs/editors/vscode">Visual Studio Code</a></li>
                <li><a href="/docs/editors/visualstudio">Visual Studio</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/build-systems">Build Systems</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/build-systems/vso">Visual Studio Team Services</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/contributing">Contributing</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/contributing/contribution-guidelines">Contribution Guidelines</a></li>
                <li><a href="/docs/contributing/documentation">Documentation</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/resources">Resources</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                                        <li><a href="/docs/resources/videos">Videos</a></li>
                <li><a href="/docs/resources/training">Training</a></li>
                <li><a href="/docs/resources/presentations">Presentations</a></li>
                <li><a href="/docs/resources/podcasts">Podcasts</a></li>
                <li><a href="/docs/resources/blogs">Blog Posts</a></li>
                <li><a href="/docs/resources/in-the-news">In The News</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



	<section class="content-header">
		<h1>Criteria</h1>
	</section>
	<section class="content">
		<html><head></head><body><p>You can control and influence the flow of the build script execution by providing criteria. This is a predicate that has to be fulfilled for the task to execute. The criteria does not affect however succeeding task will be executed.</p>
<pre><code class="language-csharp">Task("A")
    .WithCriteria(DateTime.Now.Second % 2 == 0)
    .Does(() =&gt;
    {
    });
    
Task("B")
    .WithCriteria(() =&gt; DateTime.Now.Second % 2 == 0)
    .IsDependentOn("A")
    .Does(() =&gt; 
    {
    });

RunTarget("B");
</code></pre>
<p>Task <code>A</code>'s criteria will be set when the task is created while Task <code>B</code>'s criteria will be evaluated when the task is being executed.</p>
<p>In a real project, we would control the execution of the tasks as a pipeline according to different environmental states, the repository branches, etc. In this case we get two criterias from outside to detect if local build and we are working on master branch. Notice we are using AppVeyor Build System, you can do similar stuff with other Build Systems as well.</p>
<pre><code class="language-csharp">var isLocalBuild = <a href="/api/Cake.Common.Build/BuildSystem/041CC18A">BuildSystem.IsLocalBuild</a>
var isMasterBranch = StringComparer.OrdinalIgnoreCase.Equals("master",
    BuildSystem.AppVeyor.Environment.Repository.Branch));
    
var deployUrl = HasArgument("DeployUrl") 
    ? Argument&lt;string&gt;("DeployUrl") 
    : EnvironmentVariable("DEPLOY_URL");
    
var target = "Default";

Task("Clean")
    .Does(() =&gt;
    {
    });

Task("Restore")
    .Does(() =&gt; 
    {
    });

Task("Build")    
    .Does(() =&gt;
    {
    });

Task("Migrate")    
    .WithCriteria(!isLocalBuild)
    .WithCriteria(isMasterBranch)
    .Does(() =&gt; 
    {
    });

Task("Deploy")    
    .WithCriteria(!isLocalBuild)
    .WithCriteria(isMasterBranch)
    .Does(() =&gt; 
    {
        // Deploy to some server using content and deployUrl
    });    

Task("Default")
    .IsDependentOn("Clean")
    .IsDependentOn("Restore")
    .IsDependentOn("Build")
    .IsDependentOn("Migrate")
    .IsDependentOn("Deploy")    
    .Does(() =&gt; 
    {
    });

RunTarget(target);
</code></pre>
<p>For criteria with states that might change during the execution of the build script, consider using the lambda alternative.</p>
<p>Using the previous example, we add one local var to pass to recovery mode with some error in the <code><a href="/api/Cake.EntityFramework.Models/Migration">Migration</a></code> task.</p>
<pre><code class="language-csharp">...
var target = "Default";

var isRecoveryMode = false;    

Task("Migrate")    
    .WithCriteria(!isLocalBuild)
    .WithCriteria(isMasterBranch)
    .Does(() =&gt; 
    {
    })
    .OnError(ex =&gt; 
    {
        isRecoveryMode = true
    });

Task("Deploy")    
    .WithCriteria(!isLocalBuild)
    .WithCriteria(isMasterBranch)
    .WithCriteria(() =&gt; !isRecoveryMode)
    .Does(() =&gt; 
    {        
        // Deploy to some server using content and deployUrl
    });    

Task("Recovery")
    .WithCriteria(!isLocalBuild)
    .WithCriteria(isMasterBranch)
    .WithCriteria(() =&gt; isRecoveryMode)
    .Does(() =&gt;
    {
        // Restore database
    });

Task("Default")
    .IsDependentOn("Clean")
    .IsDependentOn("Restore")
    .IsDependentOn("Build")
    .IsDependentOn("Migrate")
    .IsDependentOn("Deploy")    
    .IsDependentOn("Recovery")
    .Does(() =&gt; 
    {
    });

RunTarget(target);
</code></pre>
</body></html>
	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <p class="text-muted">
    <a href="https://github.com/cake-build/cake"><i class="fa fa-github"></i> GitHub</a> |
    <a href="https://twitter.com/cakebuildnet"><i class="fa fa-twitter"></i> Twitter</a> |
    <a href="https://gitter.im/cake-build/cake"><i class="fa fa-comment"></i> Gitter</a>
    <br/>
    Copyright &copy; <a href="http://dotnetfoundation.org">.NET Foundation</a> and contributors.
    <br/>
    Generated by <a href="http://wyam.io">Wyam</a>
</p>

<script>
    anchors.add();
</script>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        <!-- Gitter -->
<script>
    ((window.gitter = {}).chat = {}).options = {
        room: 'cake-build/cake'
    };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-60516413-1', 'auto');
    ga('send', 'pageview');
</script>
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).load(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        htmlLabels: false,
                        useMaxWidth:false
                    }
                });  
                mermaid.init(undefined, ".mermaid")
                $('svg').addClass('img-responsive');
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });
            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    </body>
</html>